# 门卫电脑 Flask 后端接口说明

## 基础信息
- 基础 URL：`http://<电脑IP>:5000`
- 所有请求和响应均使用 UTF-8 编码。

## 接口列表

### 1. 识别上传接口
**URL**: `/api/recognize`  
**方法**: `POST`  
**Content-Type**: `multipart/form-data`  
**参数**: 
- `image`: 车牌图片文件（JPEG 格式）

**响应示例**（成功）：
{
  "plate": "AF0236",
  "confidence": 0.95,
  "allowed": true,
  "message": "允许通行",
  "cooldown": false
}

**响应示例**（冷却中）：
{
  "plate": null,
  "allowed": false,
  "message": "系统冷却中，请稍后",
  "cooldown": true
}

**响应示例**（识别失败）：
{
  "plate": null,
  "allowed": false,
  "message": "未识别到车牌",
  "cooldown": false
}

---

### 2. 获取最新识别结果
**URL**: `/api/latest`  
**方法**: `GET`  
**响应**：
{
  "plate": "AF0236",
  "confidence": 0.95,
  "allowed": true,
  "time": "2025-02-15 14:30:25"
}
若无记录，返回 `null`。

---

### 3. 获取最近识别记录
**URL**: `/api/recent`  
**方法**: `GET`  
**参数**（可选）：
- `limit`: 返回记录条数，默认 10

**响应**：
[
  {
    "plate": "AF0236",
    "confidence": 0.95,
    "allowed": true,
    "time": "2025-02-15 14:30:25"
  },
  {
    "plate": "京A12345",
    "confidence": 0.92,
    "allowed": false,
    "time": "2025-02-15 14:28:10"
  }
]

---

### 4. 车牌管理接口
**基础路径**: `/api/vehicles`

#### 4.1 获取所有白名单
**URL**: `/api/vehicles`  
**方法**: `GET`  
**响应**：
[
  {"plate": "京A12345", "note": "测试车1"},
  {"plate": "沪B88888", "note": "测试车2"}
]

#### 4.2 添加车牌
**URL**: `/api/vehicles`  
**方法**: `POST`  
**请求体**（JSON）：
{
  "plate": "粤C99999",
  "note": "临时车"
}
**响应**：
- 成功：{"message": "添加成功", "plate": "粤C99999"}
- 已存在：{"error": "车牌已存在"} (409)

#### 4.3 删除车牌
**URL**: `/api/vehicles/<plate>`  
**方法**: `DELETE`  
**响应**：
- 成功：{"message": "删除成功"}
- 不存在：{"error": "车牌不存在"} (404)